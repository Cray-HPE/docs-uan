<!DOCTYPE html>
<html lang="en-2511" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0" />
    <meta name="description" content="">


    <link rel="icon" href="/docs-uan/images/favicon.png" type="image/png">

    <title> :: User Access Node (UAN)</title>

    
    <link href="/docs-uan/css/nucleus.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/fontawesome-all.min.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/hybrid.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/featherlight.min.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/perfect-scrollbar.min.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/auto-complete.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/atom-one-dark-reasonable.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/theme.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/tabs.css?1704769468" rel="stylesheet">
    <link href="/docs-uan/css/hugo-theme.css?1704769468" rel="stylesheet">
    
    <link href="/docs-uan/css/theme-green.css?1704769468" rel="stylesheet">
    
    

    <script src="/docs-uan/js/jquery-3.3.1.min.js?1704769468"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
    
  </head>
  <body class="" data-url="/docs-uan/en-2511/operations/configure_interfaces_on_uans/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/docs-uan/en-2511'>
<img src=/docs-uan/images/hpe_pri_wht_rev_rgb.png alt="HPE" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/docs-uan/js/lunr.min.js?1704769468"></script>
<script type="text/javascript" src="/docs-uan/js/auto-complete.js?1704769468"></script>
<script type="text/javascript">
    
        var baseurl = "\/docs-uan\/\/en-2511";
    
</script>
<script type="text/javascript" src="/docs-uan/js/search.js?1704769468"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/installation_prereqs/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/installation_prereqs/">
          installation prereqs
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/installation_prereqs/prepare_for_uan_product_installation/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/installation_prereqs/prepare_for_uan_product_installation/">
        Prepare for UAN Product Installation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/installation_prereqs/configure_the_bmc_for_uans_with_ilo/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/installation_prereqs/configure_the_bmc_for_uans_with_ilo/">
        Configure the BMC for UANs with iLO
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/installation_prereqs/configure_the_bios_of_an_hpe_uan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/installation_prereqs/configure_the_bios_of_an_hpe_uan/">
        Configure the BIOS of an HPE UAN
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/installation_prereqs/configure_the_bios_of_a_gigabyte_uan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/installation_prereqs/configure_the_bios_of_a_gigabyte_uan/">
        Configure the BIOS of a Gigabyte UAN
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/install/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/install/">
          install
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/install/install_the_uan_product_stream/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/install/install_the_uan_product_stream/">
        Install the UAN Product Stream
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/operations/" title="" class="dd-item
        parent
        
        
        ">
      <a href="/docs-uan/en-2511/operations/">
          operations
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/about_uan_configuration/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/about_uan_configuration/">
        About UAN Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/build_a_new_uan_image_using_the_cos_recipe/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/build_a_new_uan_image_using_the_cos_recipe/">
        Build a New UAN Image Using a COS Recipe
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/create_uan_boot_images/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/create_uan_boot_images/">
        Create UAN Boot Images
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/mount_a_new_file_system_on_an_uan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/mount_a_new_file_system_on_an_uan/">
        Mount a New File System on a UAN
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/configure_interfaces_on_uans/" title="" class="dd-item active">
        <a href="/docs-uan/en-2511/operations/configure_interfaces_on_uans/">
        Configure Interfaces on UANs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/configure_pluggable_authentication_modules_pam_on_uans/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/configure_pluggable_authentication_modules_pam_on_uans/">
        Configure Pluggable Authentication Modules (PAM) on UANs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/uan_ansible_roles/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/uan_ansible_roles/">
        UAN Ansible Roles
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/boot_uans/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/boot_uans/">
        Boot UANs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/operations/cve_2023_0461/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/operations/cve_2023_0461/">
        Mitigation for CVE-2023-0461
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/advanced/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/advanced/">
          advanced
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/advanced/customizing_uan_images_manually/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/advanced/customizing_uan_images_manually/">
        Customizing UAN Images Manually
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/advanced/enabling_can_chn/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/advanced/enabling_can_chn/">
        Enabling the Customer Access Network (CAN) or the Customer High Speed Network (CHN)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/advanced/repurposing_compute_as_uan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/advanced/repurposing_compute_as_uan/">
        Repurposing a Compute Node as a UAN
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/advanced/sles_image/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/advanced/sles_image/">
        Booting an Application Node with a SLES Image (Technical Preview)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/advanced/enabling_k3s/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/advanced/enabling_k3s/">
        Configuring a UAN for K3s (Technical Preview)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/upgrade/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/upgrade/">
          upgrade
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/upgrade/notable_changes/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/upgrade/notable_changes/">
        Notable Changes
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/upgrade/upgrade_uan_software_product/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/upgrade/upgrade_uan_software_product/">
        Upgrade UAN Software Product
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/upgrade/merge_uan_configuration_data/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/upgrade/merge_uan_configuration_data/">
        Merge UAN Configuration Data
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/troubleshooting/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/troubleshooting/">
          troubleshooting
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_boot_issues/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_boot_issues/">
        Troubleshoot UAN Boot Issues
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_cfs_and_network_configuration_issues/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_cfs_and_network_configuration_issues/">
        Troubleshoot UAN CFS and Network Configuration Issues
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_disk_configuration_issues/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/troubleshooting/troubleshoot_uan_disk_configuration_issues/">
        Troubleshoot UAN Disk Configuration Issues
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/docs-uan/en-2511/test-plan/" title="" class="dd-item
        
        
        
        ">
      <a href="/docs-uan/en-2511/test-plan/">
          test-plan
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/test-plan/test-plan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/test-plan/test-plan/">
        Test Plan for User Access Node (UAN) and Repurposed Compute Node as UAN
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-uan/en-2511/test-plan/k3s_test_plan/" title="" class="dd-item ">
        <a href="/docs-uan/en-2511/test-plan/k3s_test_plan/">
        Test Plan for UAIs on UANs (K3s Verification)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            
            Version: 
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en-271" value="/docs-uan/en-271/operations/configure_interfaces_on_uans/">2.7.1</option>
                    
                  
              
                  
              
                  
              
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="en-270" value="/docs-uan/en-270/operations/configure_interfaces_on_uans/">2.7.0</option>
                    
                  
              
                  
              
                  
              
                  
              
          
              
              
                  
              
                  
              
                  
                    
                    
                      <option id="en-262" value="/docs-uan/en-262/operations/configure_interfaces_on_uans/">2.6.2</option>
                    
                  
              
                  
              
                  
              
          
              
              
                  
              
                  
              
                  
              
                  
                    
                    
                      <option id="en-261" value="/docs-uan/en-261/operations/configure_interfaces_on_uans/">2.6.1</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
              
                  
              
                  
              
                  
                    
                    
                      <option id="en-2511" value="/docs-uan/en-2511/operations/configure_interfaces_on_uans/" selected>2.5.11</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
      </ul>
    </section>
    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/docs-uan/en-2511/'></a> > <a href='/docs-uan/en-2511/operations/'></a> > 
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#node-management-networking">Node Management Networking</a></li>
    <li><a href="#user-access-networking">User Access Networking</a></li>
    <li><a href="#procedure">Procedure</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              
            </h1>
          

        


<h1 id="configure-interfaces-on-uans">Configure Interfaces on UANs</h1>
<p>Perform this procedure to set network interfaces on UANs by editing a configuration file.</p>
<p>Interface configuration is performed by the <code>uan_interfaces</code> Ansible role. For details on the variables referred to in this procedure, see <a href="/docs-uan/en-2511/operations/uan_ansible_roles/">UAN Ansible Roles</a>.</p>
<p>In the command examples in this procedure, <code>PRODUCT_VERSION</code> refers to the current installed version of the UAN product. Replace <code>PRODUCT_VERSION</code> with the UAN version number string when executing the commands.</p>
<h2 id="node-management-networking">Node Management Networking</h2>
<p>By default, the Node Management Network (NMN) is connected to a single <code>nmn0</code> interface.  If desired, and the system networking is configured to support it, the Node Management Network may be configured as a bonded interface, <code>nmnb0</code>. To configure the NMN as a bonded pair, set <code>uan_nmn_bond</code> to true and set the interfaces to be used in the bond in <code>uan_nmn_bond_slaves</code> as described in <a href="/docs-uan/en-2511/operations/uan_ansible_roles/">UAN Ansible Roles</a>.</p>
<h2 id="user-access-networking">User Access Networking</h2>
<p>User access may be configured to use either a direct connection to the UANs from the site&rsquo;s user network, or one of two optional user access networks implemented within the HPE Cray EX system.  The two optional networks are the Customer Access Network (CAN) and Customer High Speed Network (CHN).  The CAN is a VLAN on the Node Management Network (NMN), whereas the CHN is over the High Speed Network (HSN).</p>
<p>By default, a direct connection to the site&rsquo;s user network is assumed and the Admin must define the interface(s) and default route using the <code>customer_uan_interfaces</code> and <code>customer_uan_routes</code> structures. If <code>uan_can_setup</code> is a true value, user access will be over CAN or CHN depending on what the system default route is set to in SLS.</p>
<ul>
<li>
<p>When CAN is set as the system default route in SLS and <code>uan_nmn_bond</code> is false, the bonded CAN interfaces are determined automatically.  If <code>uan_nmn_bond</code> is true, the bonded CAN interfaces must be defined by <code>uan_can_bond_slaves</code> (see <a href="/docs-uan/en-2511/operations/uan_ansible_roles/">UAN Ansible Roles</a>). The default route is set to the bonded CAN interface <code>can0</code>.</p>
</li>
<li>
<p>When CHN is set as the system default route in SLS, the CHN IP is added to <code>hsn0</code> by default, but can be changed by using setting <code>uan_chn_device</code> to the desired interface.  The default route is set to the CHN.</p>
</li>
<li>
<p>The Admin may override the CAN/CHN default route by setting <code>uan_customer_default_route</code> to true and defining the default route in <code>customer_uan_routes</code>.</p>
</li>
</ul>
<h2 id="procedure">Procedure</h2>
<p>Network configuration settings are defined in the <code>uan-config-management</code> VCS repo under the <code>group_vars/ROLE_SUBROLE/</code> or <code>host_vars/XNAME/</code> directories, where <code>ROLE_SUBROLE</code> must be replaced by the role and subrole assigned for the node in HSM, and <code>XNAME</code> with the xname of the node. Values under <code>group_vars/ROLE_SUBROLE/</code> apply to all nodes with the given role and subrole.  Values under the <code>host_vars/XNAME/</code> apply to the specific node with the xname and will override any values set in <code>group_vars/ROLE_SUBROLE/</code>.  A yaml file is used by the Configuration Framwork Service (CFS).  The examples in this procedure use <code>customer_net.yml</code>, but any filename may be used.  Admins must create this yaml file and use the variables described in this procedure.</p>
<p>If the HPE Cray EX CAN or CHN is desired, set the <code>uan_can_setup</code> variable to <code>yes</code> in the yaml file.  The UAN will be configured to use the CAN or CHN based on what the BICAN System Default Route is set to in SLS.</p>
<ol>
<li>
<p>Obtain the password for the <code>crayvcs</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# kubectl get secret -n services vcs-user-credentials <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span> --template<span style="color:#f92672">={{</span>.data.vcs_password<span style="color:#f92672">}}</span> | base64 --decode
</span></span></code></pre></div></li>
<li>
<p>Log in to ncn-w001.</p>
</li>
<li>
<p>Create a copy of the Git configuration. Enter the credentials for the <code>crayvcs</code> user when prompted.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# git clone https://api-gw-service-nmn.local/vcs/cray/uan-config-management.git
</span></span></code></pre></div></li>
<li>
<p>Change to the <code>uan-config-management</code> directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# cd uan-config-management
</span></span></code></pre></div></li>
<li>
<p>Edit the yaml file, (<code>customer_net.yml</code>, for example), in either the <code>group_vars/ROLE_SUBROLE/</code> or <code>host_vars/XNAME</code> directory and configure the values as needed.</p>
<p>To enable bonded NMN interfaces:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## uan_nmn_bond</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set uan_nmn_bond to &#39;yes&#39; if the site will</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># implement a bonded NMN connection.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, uan_nmn_bond is set to &#39;no&#39;.</span>
</span></span><span style="display:flex;"><span>uan_nmn_bond: yes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## uan_nmn_bond_slaves</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># These are the default NMN bond slaves.  They may need to be</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># changed based on the actual system hardware configuration.</span>
</span></span><span style="display:flex;"><span>uan_nmn_bond_slaves:
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;ens10f0&#34;</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;ens1f0&#34;</span>
</span></span></code></pre></div><p>To set up CAN or CHN:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## uan_can_setup</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set uan_can_setup to &#39;yes&#39; if the site will</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># use the Shasta CAN or CHN network for user access.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, uan_can_setup is set to &#39;no&#39;.</span>
</span></span><span style="display:flex;"><span>uan_can_setup: yes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## uan_can_bond_slaves</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This variable only applies when the system default route is CAN</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># and `uan_nmn_bond` is true.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># These are the default CAN bond slaves.  They may need to be</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># changed based on the actual system hardware configuration.</span>
</span></span><span style="display:flex;"><span>uan_can_bond_slaves:
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;ens10f1&#34;</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;ens1f1&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## uan_chn_device</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This variable allows the admin to select which interface will </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># be used for the CHN device.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, &#34;hsn0&#34; is used for CHN.</span>
</span></span><span style="display:flex;"><span>uan_chn_device: <span style="color:#e6db74">&#34;hsn0&#34;</span>
</span></span></code></pre></div><p>To allow a custom default route when CAN or CHN is selected:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## uan_customer_default_route</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Allow a custom default route when CAN or CHN is selected.</span>
</span></span><span style="display:flex;"><span>uan_customer_default_route: no
</span></span></code></pre></div><p>To define interfaces:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## Customer defined networks ifcfg-X</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_interfaces is as list of interface names used for constructing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ifcfg-&lt;customer_uan_interfaces.name&gt; files.  The setting dictionary is where</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># any desired ifcfg fields are defined.  The field name will be converted to </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uppercase in the generated ifcfg-&lt;name&gt; file.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NOTE: Interfaces should be defined in order of dependency.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Example ifcfg fields, not exhaustive:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  bootproto: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  device: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  dhcp_hostname: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  ethtool_opts: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  gateway: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  hwaddr: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  ipaddr: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  master: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  mtu: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  peerdns: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  prefixlen: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  slave: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  srcaddr: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  startmode: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  userctl: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  bonding_master: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  bonding_module_opts: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  bonding_slave0: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  bonding_slave1: &#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_interfaces:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     settings:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       bootproto: &#34;static&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       device: &#34;net1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       ipaddr: &#34;1.2.3.4&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       startmode: &#34;auto&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     settings:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       bootproto: &#34;static&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       device: &#34;net2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       ipaddr: &#34;5.6.7.8&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       startmode: &#34;auto&#34;</span>
</span></span><span style="display:flex;"><span>customer_uan_interfaces: <span style="color:#f92672">[]</span>
</span></span></code></pre></div><p>To define interface static routes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## Customer defined networks ifroute-X</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_routes is as list of interface routes used for constructing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ifroute-&lt;customer_uan_routes.name&gt; files.  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_routes:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     routes:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;10.92.100.0 10.252.0.1 255.255.255.0 -&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;10.100.0.0 10.252.0.1 255.255.128.0 -&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     routes:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;default 10.103.8.20 255.255.255.255 - table 3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;10.103.8.128/25 10.103.8.20 255.255.255.255 net2&#34;</span>
</span></span><span style="display:flex;"><span>customer_uan_routes: <span style="color:#f92672">[]</span>
</span></span></code></pre></div><p>To define the rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## Customer defined networks ifrule-X</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_rules is as list of interface rules used for constructing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ifrule-&lt;customer_uan_routes.name&gt; files.  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_rules:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     rules:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;from 10.1.0.0/16 lookup 1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - name: &#34;net2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     rules:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;from 10.103.8.0/24 lookup 3&#34;</span>
</span></span><span style="display:flex;"><span>customer_uan_rules: <span style="color:#f92672">[]</span>
</span></span></code></pre></div><p>To define the global static routes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## Customer defined networks global routes</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_global_routes is as list of global routes used for constructing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the &#34;routes&#34; file.  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># customer_uan_global_routes:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - routes: </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;10.92.100.0 10.252.0.1 255.255.255.0 -&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       - &#34;10.100.0.0 10.252.0.1 255.255.128.0 -&#34;</span>
</span></span><span style="display:flex;"><span>customer_uan_global_routes: <span style="color:#f92672">[]</span>
</span></span></code></pre></div></li>
<li>
<p>Add the change from the working directory to the staging area.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# git add -A
</span></span></code></pre></div></li>
<li>
<p>Commit the file to the master branch.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# git commit -am <span style="color:#e6db74">&#39;Added UAN interfaces&#39;</span>
</span></span></code></pre></div></li>
<li>
<p>Push the commit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# git push
</span></span></code></pre></div></li>
<li>
<p>Obtain the commit ID for the commit pushed in the previous step.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# git rev-parse --verify HEAD
</span></span></code></pre></div></li>
<li>
<p>Update any CFS configurations used by the UANs with the commit ID from the previous step.</p>
<p>a. Download the JSON of the current UAN CFS configuration to a file.</p>
<p>This file will be named <code>uan-config-PRODUCT_VERSION.json</code>. Replace <code>PRODUCT_VERSION</code> with the current installed UAN version.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    ncn-m001#  cray cfs configurations describe uan-config-PRODUCT_VERSION <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>     --format<span style="color:#f92672">=</span>json &gt;uan-config-PRODUCT_VERSION.json
</span></span></code></pre></div><p>b. Remove the unneeded lines from the JSON file.</p>
<pre><code>The lines to remove are:

   - the `lastUpdated` line
   - the last `name` line 

These must be removed before uploading the modified JSON file back into CFS to update the UAN configuration.

```bash
ncn-m001# cat uan-config-PRODUCT_VERSION.json
{
  &quot;lastUpdated&quot;: &quot;2021-03-27T02:32:10Z&quot;,      
  &quot;layers&quot;: [
    {
      &quot;cloneUrl&quot;: &quot;https://api-gw-service-nmn.local/vcs/cray/uan-config-management.git&quot;,
      &quot;commit&quot;: &quot;aa5ce7d5975950ec02493d59efb89f6fc69d67f1&quot;,
      &quot;name&quot;: &quot;uan-integration-PRODUCT_VERSION&quot;,
      &quot;playbook&quot;: &quot;site.yml&quot;
    },
  &quot;name&quot;: &quot;uan-config-2.0.1-full&quot;            
} 
```
</code></pre>
<p>c. Replace the <code>commit</code> value in the JSON file with the commit ID obtained in the previous Step.</p>
<pre><code>The name value after the commit line may also be updated to match the new UAN product version, if desired. This is not necessary as CFS does not use this value for the configuration name.

```bash
{
 &quot;layers&quot;: [
 {
 &quot;cloneUrl&quot;: &quot;https://api-gw-service-nmn.local/vcs/cray/uan-configmanagement.git&quot;,
 &quot;commit&quot;: &quot;aa5ce7d5975950ec02493d59efb89f6fc69d67f1&quot;,
 &quot;name&quot;: &quot;uan-integration-PRODUCT_VERSION&quot;,
 &quot;playbook&quot;: &quot;site.yml&quot;
 }
 ]
}
```
</code></pre>
<p>d. Create a new UAN CFS configuration with the updated JSON file.</p>
<p>The following example uses <code>uan-config-PRODUCT_VERSION</code> for the name of the new CFS configuration, to match the JSON file name.</p>
<pre><code>```bash
ncn-m001# cray cfs configurations update uan-config-PRODUCT_VERSION \
 --file uan-config-PRODUCT_VERSION.json
```
</code></pre>
<p>e. Tell CFS to apply the new configuration to UANs by repeating the following command for each UAN. Replace <code>UAN_XNAME</code> in the command below with the name of a different UAN each time the command is run.</p>
<pre><code>```bash
ncn-m001# cray cfs components update --desired-config uan-config-PRODUCT_VERSION \
--enabled true --format json UAN_XNAME
```
</code></pre>
</li>
<li>
<p>Reboot the UAN with the Boot Orchestration Service (BOS).</p>
<p>The new interfaces will be available when the UAN is rebooted. Replace the <code>UAN_SESSION_TEMPLATE</code> value with the BOS session template name for the UANs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-w001# cray bos v1 session create <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span> --template-uuid UAN_SESSION_TEMPLATE --operation reboot
</span></span></code></pre></div></li>
<li>
<p>Verify that the desired networking configuration is correct on each UAN.</p>
</li>
</ol>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs-uan/js/clipboard.min.js?1704769468"></script>
    <script src="/docs-uan/js/perfect-scrollbar.min.js?1704769468"></script>
    <script src="/docs-uan/js/perfect-scrollbar.jquery.min.js?1704769468"></script>
    <script src="/docs-uan/js/jquery.sticky.js?1704769468"></script>
    <script src="/docs-uan/js/featherlight.min.js?1704769468"></script>
    <script src="/docs-uan/js/highlight.pack.js?1704769468"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs-uan/js/modernizr.custom-3.6.0.js?1704769468"></script>
    <script src="/docs-uan/js/learn.js?1704769468"></script>
    <script src="/docs-uan/js/hugo-learn.js?1704769468"></script>
    
        
            <script src="/docs-uan/mermaid/mermaid.js?1704769468"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

