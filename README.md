# UAN Docs generated by Hugo

In this repository are all the files needed to generate UAN documentation in
static HTML format from the markdown source in the `uan-product-stream` repository.

## Building and Publishing the HTML Documentation

To build and publish the HTML files for the UAN documentation, run the `build-hugo-docs.py`
script from this directory.  Here's the usage statement:

```bash
build-hugo-docs.py -h
Usage: build-hugo-docs.py [options]

Options:
  -h, --help            show this help message and exit
  -f RELEASE_FILE, --release-file=RELEASE_FILE
                        file containing list of releases
  --no-clone            flag to not clone the doc source
  --no-publish          flag to not publish to github pages
  -r RELEASE1,RELEASE2,..., --releases=RELEASE1,RELEASE2,...
                        comma-separated list of releases
```

The `build-hugo-docs.py` script performs the following steps:

1. Generates the following files based on the releases listed in  `release_list.yml` file.
These files control how hugo is configured and launch hugo to build the docs.

    * `docs/hugo/docs-uan/bin/build.sh` - the script that clones the doc source and calls hugo
    to build the docs

    * `docs/hugo/docs-uan/config.toml` - the hugo configuration file

    * `docs/hugo/docs-uan/bin/compose/hugo_prep.yml` configuration to convert the raw doc
    markdown source into a hugo annotated markdown format

    * `docs/hugo/docs-uan/bin/compose/test.yml` - builds link checkers that ensure the links
    within the document files are valid

    The values in `release_list.yml` may be overwritten on the command line
    by the `-r` or `--releases` options.

    The path and name of the `release_list.yml` may be overwritten on the
    command line by the `-f` or `--release-file` options.

1. Builds the HTML documents by calling the newly generated `bin/build.sh` script.  By
default, `docs/hugo/docs-uan/bin/build.sh` will clone the document source for each
release to a working directory - `docs/hugo/docs-uan/docs-uan/RELEASE`, where
RELEASE is a release name being built.

    ***NOTE*** If any modifications need to be made to the cloned document
    source before publishing the docs, be sure to add the `--no-publish`
    option to the `build-hugo-docs.py` command line.  This will clone
    the document source to the working directory and not publish to the
    github pages repository.  Changes can then be made to the source.  When
    the modifications are completed, `build-hugo-docs.py --no-clone` must
    be run to rebuild and publish the modified documentation to the github
    pages repository.

## Viewing the HTML UAN Documentation

By default, the documentation is published to the UAN github pages documentation
URL - `https://cray-hpe.github.io/docs-uan`.

When `build-hugo-docs.py --no-publish` is executed, the HTML documentation
may be viewed by running the `bin/dev.sh` script from `docs/hugo/docs-uan`.
The `bin/dev.sh` script will start a local webserver and host the documentation
at `http://localhost/uan`.

Alternatively, the contents of `docs/hugo/docs-uan/public`
may be copied to any webserver.
