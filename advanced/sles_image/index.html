<!DOCTYPE html>
<html lang="en-255" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0">
    <meta name="generator" content="Relearn 5.8.1+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="">
    <title>User Access Node (UAN)</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/docs-uan/css/fontawesome-all.min.css?1670951100" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/docs-uan/css/fontawesome-all.min.css?1670951100" rel="stylesheet"></noscript>
    <link href="/docs-uan/css/featherlight.min.css?1670951100" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/docs-uan/css/featherlight.min.css?1670951100" rel="stylesheet"></noscript>
    <link href="/docs-uan/css/auto-complete.css?1670951100" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/docs-uan/css/auto-complete.css?1670951100" rel="stylesheet"></noscript>
    <link href="/docs-uan/css/perfect-scrollbar.min.css?1670951100" rel="stylesheet">
    <link href="/docs-uan/css/nucleus.css?1670951100" rel="stylesheet">
    <link href="/docs-uan/css/fonts.css?1670951100" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/docs-uan/css/fonts.css?1670951100" rel="stylesheet"></noscript>
    <link href="/docs-uan/css/theme.css?1670951100" rel="stylesheet">
    <link href="/docs-uan/css/theme-green.css?1670951100" rel="stylesheet" id="variant-style">
    <link href="/docs-uan/css/ie.css?1670951100" rel="stylesheet">
    <link href="/docs-uan/css/variant.css?1670951100" rel="stylesheet">
    <link href="/docs-uan/css/print.css?1670951100" rel="stylesheet" media="print">
    <script src="/docs-uan/js/url.js?1670951100"></script>
    <script src="/docs-uan/js/variant.js?1670951100"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/docs-uan/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = '';
      window.T_Copied_to_clipboard = '';
      window.T_Copy_link_to_clipboard = '';
      window.T_Link_copied_to_clipboard = '';
      window.T_No_results_found = '';
      window.T_N_results_found = '';
      // some further base stuff
      var baseUriFull='docs-uan/';
      window.variants && variants.init( [ 'green' ] );
    </script>
    <script src="/docs-uan/js/jquery.min.js?1670951100" defer></script>
  </head>
  <body class="mobile-support html" data-url="/docs-uan/advanced/sles_image/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title=' (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <span id="toc-menu" title=' (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/docs-uan/index.html"><span itemprop="name">User Access Node (UAN)</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/docs-uan/advanced/index.html"><span itemprop="name">User Access Node (UAN)</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">User Access Node (UAN)</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
          <div class="default-animation progress">
            <div class="toc-wrapper" dir="ltr">
<nav id="TableOfContents">
  <ul>
    <li><a href="#limitations">Limitations</a></li>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#procedure">Procedure</a></li>
    <li><a href="#troubleshooting">Troubleshooting</a>
      <ul>
        <li><a href="#dracut-failures-during-booting">Dracut failures during booting</a></li>
        <li><a href="#unable-to-log-in-to-the-node">Unable to log in to the node.</a></li>
        <li><a href="#dhcp-hostname-is-not-set">DHCP hostname is not set</a></li>
        <li><a href="#spire-is-not-running">Spire is not running</a></li>
      </ul>
    </li>
  </ul>
</nav>
            </div>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
<h1 id=""></h1>

<h1 id="booting-an-application-node-with-a-sles-image-technical-preview">Booting an Application Node with a SLES Image (Technical Preview)</h1>
<p>A SLES image is available for use with Application type nodes. This image is currently considered a &ldquo;Technical Preview&rdquo; as the initial support for booting with SLES Images without COS. This guide documents the procedure to boot and configure the new image as it currently differs from the standard COS-based image process in some ways.</p>
<p>The image is built with the same packer/qemu pipeline as Non-Compute-Node Images. Similarties may be noticed including the kernel and package versions.</p>
<h2 id="limitations">Limitations</h2>
<p>As this is currently a &ldquo;Technical Preview&rdquo; of supporting SLES Images on Application Nodes, there are several limitations:</p>
<ul>
<li>S3 presigned URLs with an expiration limit for the rootfs must be created.</li>
<li>BSS parameters must be set with <code>cray bss bootparameters replace ...</code></li>
<li>BOS Sessions and Templates are not supported.</li>
<li>CFS Configurations that operate on COS and NCN images are not yet supported.</li>
<li>CFS Node Personalization must be started manually.</li>
</ul>
<h2 id="overview">Overview</h2>
<p>The following steps outline the process of configuring and booting an Application Node with the SLES Image.</p>
<ol>
<li>
<p>Determine the image to use.</p>
</li>
<li>
<p>Configure the image with IMS/CFS (optional).</p>
</li>
<li>
<p>Update BSS with the necessary parameters.</p>
</li>
<li>
<p>Reboot the node.</p>
</li>
<li>
<p>Run CFS Node Personalization (optional).</p>
</li>
</ol>
<h2 id="procedure">Procedure</h2>
<p>Perform the following steps to configure and boot a SLES image on an Application type node.</p>
<ol>
<li>
<p>Log in to the master node <code>ncn-m001</code>. All commands in this procedure are run from the master node.</p>
</li>
<li>
<p>Verify the UAN release contains a SLES image.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# UAN_RELEASE<span style="color:#f92672">=</span>2.5
</span></span><span style="display:flex;"><span>ncn-m001# sat showrev --filter <span style="color:#e6db74">&#39;product_name = uan&#39;</span> | grep $UAN_RELEASE
</span></span></code></pre></div></li>
<li>
<p>Select an Image to boot or customize.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# APP_IMAGE_NAME<span style="color:#f92672">=</span>cray-application-sles15sp3.x86_64-0.1.0
</span></span><span style="display:flex;"><span>ncn-m001# APP_IMAGE_ID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cray ims images list --format json  | jq --arg APP_IMAGE_NAME <span style="color:#e6db74">&#34;</span>$APP_IMAGE_NAME<span style="color:#e6db74">&#34;</span> -r <span style="color:#e6db74">&#39;sort_by(.created) | .[] | select(.name == $APP_IMAGE_NAME ) | .id&#39;</span> | head -1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>ncn-m001# cray ims images describe $APP_IMAGE_ID --format json
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;created&#34;</span>: <span style="color:#e6db74">&#34;2022-08-24T20:07:27.263737+00:00&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;13964414-bbad-40e9-9e31-a3683010febb&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;link&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;etag&#34;</span>: <span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>path<span style="color:#e6db74">&#34;: &#34;</span>s3://boot-images/13964414-bbad-40e9-9e31-a3683010febb/manifest.json<span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>type<span style="color:#e6db74">&#34;: &#34;</span>s3<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;</span>name<span style="color:#e6db74">&#34;: &#34;</span>cray-application-sles15sp3.x86_64-0.1.0<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span></code></pre></div></li>
<li>
<p>Customize the image using SAT Bootprep. This will add a root password to the image as one is not included. If CFS is not going to be used on this node, this step is optional. Support for additional product layers will be added in subsequent releases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# cat bootprep-sles-uan.yml
</span></span><span style="display:flex;"><span>configurations:
</span></span><span style="display:flex;"><span>- name: sles-uan-configuration
</span></span><span style="display:flex;"><span>  layers:
</span></span><span style="display:flex;"><span>  - name: uan
</span></span><span style="display:flex;"><span>    playbook: site.yml
</span></span><span style="display:flex;"><span>    product:
</span></span><span style="display:flex;"><span>      name: uan
</span></span><span style="display:flex;"><span>      version: 2.5.3
</span></span><span style="display:flex;"><span>      branch: integration
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>images:
</span></span><span style="display:flex;"><span>- name: sles-uan-image
</span></span><span style="display:flex;"><span>  ims:
</span></span><span style="display:flex;"><span>    is_recipe: false
</span></span><span style="display:flex;"><span>    name: cray-application-sles15sp3.x86_64-0.1.0
</span></span><span style="display:flex;"><span>  configuration: sles-uan-configuration
</span></span><span style="display:flex;"><span>  configuration_group_names:
</span></span><span style="display:flex;"><span>  - Application
</span></span><span style="display:flex;"><span>  - Application_UAN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ncn-m001# sat bootprep run ./bootprep-sles-uan.yml
</span></span><span style="display:flex;"><span>ncn-m001# APP_IMAGE_NAME<span style="color:#f92672">=</span>sles-uan-image
</span></span><span style="display:flex;"><span>ncn-m001# APP_IMAGE_ID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cray ims images list --format json  | jq --arg APP_IMAGE_NAME <span style="color:#e6db74">&#34;</span>$APP_IMAGE_NAME<span style="color:#e6db74">&#34;</span> -r <span style="color:#e6db74">&#39;sort_by(.created) | .[] | select(.name == $APP_IMAGE_NAME ) | .id&#39;</span> | head -1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>ncn-m001# cray ims images describe $APP_IMAGE_ID --format json
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;created&#34;</span>: <span style="color:#e6db74">&#34;2022-08-25T20:07:27.263737+00:00&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;13964414-bbad-40e9-9e31-a36830101234&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;link&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;etag&#34;</span>: <span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>path<span style="color:#e6db74">&#34;: &#34;</span>s3://boot-images/13964414-bbad-40e9-9e31-a36830101234/manifest.json<span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>type<span style="color:#e6db74">&#34;: &#34;</span>s3<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;</span>name<span style="color:#e6db74">&#34;: &#34;</span>sles-uan-image<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span></code></pre></div></li>
<li>
<p>Create a presigned URL for the rootfs. This is needed for the node to boot in this release, in the future, this will be integrated into BSS and will not need to be performed. This URL will be valid for 1 hour and will need to be recreated if the node reboots after the URL expires. To set a longer expiration, adjust the &ldquo;aws s3 presign&rdquo; command accordingly.</p>
<pre tabindex="0"><code class="language-base" data-lang="base">ncn-m001# export AWS_ACCESS_KEY_ID=`kubectl get secrets -o yaml ims-s3-credentials -ojsonpath=&#39;{.data.access_key}&#39; | base64 -d`
ncn-m001# export AWS_SECRET_ACCESS_KEY=`kubectl get secrets -o yaml ims-s3-credentials -ojsonpath=&#39;{.data.secret_key}&#39; | base64 -d`
ncn-m001# alias aws=&#34;aws --endpoint-url http://rgw-vip&#34;
ncn-m001# ROOTFS_URL=$(aws s3 presign --expires-in 3600 s3://boot-images/$APP_IMAGE_ID/rootfs)
</code></pre></li>
<li>
<p>Select an Application UAN to boot with the image.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# cray hsm state components list --role Application --subrole UAN --format json | jq -r <span style="color:#e6db74">&#39;.Components | .[] | .ID&#39;</span>
</span></span><span style="display:flex;"><span>x3000c0s13b0n0
</span></span><span style="display:flex;"><span>x3000c0s15b0n0
</span></span><span style="display:flex;"><span>ncn-m001# NODE<span style="color:#f92672">=</span>x3000c0s13b0n0
</span></span></code></pre></div></li>
<li>
<p>Select a MAC address to use as the NMN interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001:~ <span style="color:#75715e"># cray hsm inventory ethernetInterfaces list --component-id $NODE --format json | jq -r &#39;.[] | &#34;\(.Description) \t \(.MACAddress)&#34;&#39;</span>
</span></span><span style="display:flex;"><span>Ethernet Interface Lan1 	 b4:2e:99:fd:45:c8
</span></span><span style="display:flex;"><span>Ethernet Interface Lan2 	 b4:2e:99:fd:45:c9
</span></span><span style="display:flex;"><span>ncn-m001:~ <span style="color:#75715e"># MAC=b4:2e:99:fd:45:c8</span>
</span></span></code></pre></div></li>
<li>
<p>Update BSS with the kernel, initrd, and desired parameters.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001:~ <span style="color:#75715e"># PARAMS=&#34;ifname=nmn0:$MAC ip=nmn0:dhcp spire_join_token=\${SPIRE_JOIN_TOKEN} biosdevname=1 pcie_ports=native transparent_hugepage=never console=tty0 console=ttyS0,115200 iommu=pt metal.no-wipe=1 initrd=initrd root=live:$ROOTFS_URL rd.live.ram=0 rd.writable.fsimg=0 rd.skipfsck rd.live.squashimg=filesystem.squashfs rd.live.overlay.thin=1 rd.live.overlay.overlayfs=1 rd.luks=0 rd.luks.crypttab=0 rd.lvm.conf=0 rd.lvm=1 rd.auto=1 rd.md=1 rd.dm=0 rd.neednet=0 rd.peerdns=1 rd.md.waitclean=1 rd.multipath=0 rd.md.conf=1 rd.bootif=0 hostname=$NODE rd.net.dhcp.retry=3 append nosplash quiet log_buf_len=1 rd.retry=10 rd.shell&#34;</span>
</span></span><span style="display:flex;"><span>ncn-m001:~ <span style="color:#75715e"># cray bss bootparameters replace --hosts $NODE --initrd &#34;s3://boot-images/$APP_IMAGE_ID/initrd&#34; --kernel &#34;s3://boot-images/$APP_IMAGE_ID/kernel&#34; --params &#34;$PARAMS&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Reboot the node. Wait for the status to return off before issuing the power on command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001:# USERNAME<span style="color:#f92672">=</span>root
</span></span><span style="display:flex;"><span>ncn-m001:# read -r -s -p <span style="color:#e6db74">&#34;</span>$NODE<span style="color:#e6db74"> BMC </span><span style="color:#e6db74">${</span>USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> password: &#34;</span> IPMI_PASSWORD; echo
</span></span><span style="display:flex;"><span>ncn-m001:# export IPMI_PASSWORD
</span></span><span style="display:flex;"><span>ncn-m001:# ipmitool -U <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -E -I lanplus -H <span style="color:#e6db74">${</span>NODE:<span style="color:#66d9ef">:-</span>2<span style="color:#e6db74">}</span> power off
</span></span><span style="display:flex;"><span>ncn-m001:# ipmitool -U <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -E -I lanplus -H <span style="color:#e6db74">${</span>NODE:<span style="color:#66d9ef">:-</span>2<span style="color:#e6db74">}</span> power status
</span></span><span style="display:flex;"><span>ncn-m001:# ipmitool -U <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -E -I lanplus -H <span style="color:#e6db74">${</span>NODE:<span style="color:#66d9ef">:-</span>2<span style="color:#e6db74">}</span> power on
</span></span></code></pre></div></li>
<li>
<p>Connect to the console for the node and verify it boots into multi-user mode. Find the correct pod by using <code>conman -q</code> to list the available connections in each pod.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001# kubectl exec -it -n services cray-console-node-0 -- conman -j $NODE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>2022-08-25 14:27:51 Welcome to SUSE Linux Enterprise High Performance Computing <span style="color:#ae81ff">15</span> SP3  <span style="color:#f92672">(</span>x86_64<span style="color:#f92672">)</span> - Kernel 5.3.18-150300.59.43-default <span style="color:#f92672">(</span>ttyS0<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>2022-08-25 14:27:51
</span></span><span style="display:flex;"><span>2022-08-25 14:27:51 x3000c0s13b0n0 login:
</span></span></code></pre></div></li>
<li>
<p>If the node does not complete the boot successfully, proceed to the troubleshooting section in this guide.</p>
</li>
</ol>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>Some general troublshooting tips may help in getting started using the SLES image.</p>
<h3 id="dracut-failures-during-booting">Dracut failures during booting</h3>
<ol>
<li>
<p>Could not find the kernel or the initrd. Verify the BSS bootparameters for the node. Specifically, check that the IMS Image ID is correct.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http://rgw-vip.nmn/boot-images/13964414-bbad-40e9-9e31-a3683010febbasdf/kernel...HTTP 0x7f0fa808 status <span style="color:#ae81ff">404</span> Not Found
</span></span><span style="display:flex;"><span> No such file or directory <span style="color:#f92672">(</span>http://ipxe.org/2d0c618e<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://rgw-vip.nmn/boot-images/13964414-bbad-40e9-9e31-a3683010febbasdf/initrd...HTTP 0x7f0fa808 status <span style="color:#ae81ff">404</span> Not Found
</span></span><span style="display:flex;"><span> No such file or directory <span style="color:#f92672">(</span>http://ipxe.org/2d0c618e<span style="color:#f92672">)</span>
</span></span></code></pre></div></li>
<li>
<p>The presigned URL was generated incorrectly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>2022-08-22 18:49:33 <span style="color:#f92672">[</span>    9.170981<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1427<span style="color:#f92672">]</span>: curl: <span style="color:#f92672">(</span>22<span style="color:#f92672">)</span> The requested URL returned error: <span style="color:#ae81ff">404</span> Not Found
</span></span><span style="display:flex;"><span>2022-08-22 18:49:33 <span style="color:#f92672">[</span>    9.191138<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1421<span style="color:#f92672">]</span>: Warning: Downloading <span style="color:#e6db74">&#39;http://rgw-vip/boot-images/c0d2d5fd-8354-4f21-a0ef-8ee2878cbde7/filesystem.squashfs?AWSAccessKeyId=I
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">43RBLH07R65TRO3AL02&amp;Signature=YLmTttUa2KT7qzKLemOd1zIsWlo%3D&amp;Expires=1661273999&#39;</span> failed!
</span></span><span style="display:flex;"><span>2022-08-22 18:49:33 <span style="color:#f92672">[</span>    9.222966<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1411<span style="color:#f92672">]</span>: Warning: failed to download live image: error <span style="color:#ae81ff">0</span>
</span></span></code></pre></div></li>
<li>
<p>No carrier detected on interface nmn0. Select a different MAC address to be assigned as nmn0.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http://rgw-vip.nmn/boot-images/13964414-bbad-40e9-9e31-a3683010febb/kernel... ok
</span></span><span style="display:flex;"><span>http://rgw-vip.nmn/boot-images/13964414-bbad-40e9-9e31-a3683010febb/initrd... ok
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>    4.966173<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>975<span style="color:#f92672">]</span>: Warning: Unable to retrieve metadata from server
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>    5.379611<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1130<span style="color:#f92672">]</span>: Warning: Unable to retrieve metadata from server
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>   10.547290<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1144<span style="color:#f92672">]</span>: Warning: No carrier detected on interface nmn0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>   10.564694<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1393<span style="color:#f92672">]</span>: ls: cannot access <span style="color:#e6db74">&#39;/tmp/leaseinfo.nmn0*&#39;</span>: No such file or directory
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>   28.381198<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>945<span style="color:#f92672">]</span>: Warning: dracut-initqueue timeout - starting timeout scripts
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>   28.400096<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>945<span style="color:#f92672">]</span>: Warning: Could not boot.
</span></span></code></pre></div></li>
<li>
<p>The root filesystem doesn&rsquo;t won&rsquo;t download because the URL is too long. Regenerate the URL using the aws command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>2022-08-03 19:41:52   <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> --:--:-- --:--:-- --:--:--     0Warning: Failed to create the file
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.842822<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: Warning: rootfs?X-Amz-Algorithm<span style="color:#f92672">=</span>AWS4-HMAC-SHA256&amp;X-Amz-Credential<span style="color:#f92672">=</span>I43RBLH07R65T
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.862811<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: Warning: RO3AL02%2F20220803%2F%2Fs3%2Faws4_request&amp;X-Amz-Date<span style="color:#f92672">=</span>20220803T193518Z&amp;
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.882714<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: Warning: X-Amz-Expires<span style="color:#f92672">=</span>86400&amp;X-Amz-SignedHeaders<span style="color:#f92672">=</span>host&amp;X-Amz-Signature<span style="color:#f92672">=</span>9412c9eb0
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.902718<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: Warning: 585604b3c8154376113c043fb41e3954cddc92a8d799e5176f8c140: File name
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.922710<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: Warning: too long
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.938714<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52   <span style="color:#ae81ff">0</span> 2020M    <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">13977</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>   524k      <span style="color:#ae81ff">0</span>  1:05:40 --:--:--  1:05:40  524k
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.958983<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1428<span style="color:#f92672">]</span>: curl: <span style="color:#f92672">(</span>23<span style="color:#f92672">)</span> Failed writing body <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> !<span style="color:#f92672">=</span> 13977<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>    9.975166<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1422<span style="color:#f92672">]</span>: Warning: Downloading <span style="color:#e6db74">&#39;http://rgw-vip/boot-images/66c37928-6887-463e-8d9f-e4eec8089374/rootfs?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=I43RBLH07R65TRO3AL02%2F20220803%2F%2Fs3%2Faws4_request&amp;X-Amz-Date=20220803T193518Z&amp;X-Amz-Expires=86400&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=9412c9eb0585604b3c8154376113c043fb41e3954cddc92a8d799e5176f8c140&#39;</span> failed!
</span></span><span style="display:flex;"><span>2022-08-03 19:41:52 <span style="color:#f92672">[</span>   10.019096<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1412<span style="color:#f92672">]</span>: Warning: failed to download live image: error <span style="color:#ae81ff">0</span>
</span></span></code></pre></div></li>
<li>
<p>The presigned URL has expired or was generated incorrectly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>    9.787431<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1435<span style="color:#f92672">]</span>: curl: <span style="color:#f92672">(</span>22<span style="color:#f92672">)</span> The requested URL returned error: <span style="color:#ae81ff">403</span> Forbidden
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>    9.807724<span style="color:#f92672">]</span> dracut-initqueue<span style="color:#f92672">[</span>1429<span style="color:#f92672">]</span>: Warning: Downloading <span style="color:#e6db74">&#39;http://rgw-vip/boot-images/13964414-bbad-40e9-9e31-a3683010febb/rootfs?AWSAccessKeyId=I43RBLH07R65TRO3AL02&amp;Signature=7%2FgOCotleoyLPGmeyG%2FFX8tpkWg%3D&amp;Expires=1661523713&#39;</span> failed!
</span></span></code></pre></div></li>
<li>
<p>The dracut module livenet is missing from the initrd. Make sure the initrd was regenerated with <code>/srv/cray/scripts/common/create-ims-initrd.sh</code> if CFS was used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>2022-08-24 14:48:53 <span style="color:#f92672">[</span>    5.784023<span style="color:#f92672">]</span> dracut: FATAL: Don<span style="color:#e6db74">&#39;t know how to handle &#39;</span>root<span style="color:#f92672">=</span>live:http://rgw-vip/boot-images/e88ed416-5d58-4421-9013-fa2171ac11b8/rootfs?AWSAccessKeyId<span style="color:#f92672">=</span>I43RBLH07R65TRO3AL02&amp;Signature<span style="color:#f92672">=</span>bL661kZHPyEgBsLLEuJHFz3zKVs%3D&amp;Expires<span style="color:#f92672">=</span>1661438587<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>2022-08-24 14:48:53 <span style="color:#f92672">[</span>    5.805063<span style="color:#f92672">]</span> dracut: Refusing to <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="unable-to-log-in-to-the-node">Unable to log in to the node.</h3>
<ol>
<li>
<p>The node is not up. Connect to the console and determine why the node has not booted, starting with the troubleshooting tips.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001:# ssh app01 
</span></span><span style="display:flex;"><span>ssh: connect to host uan01 port 22: No route to host
</span></span></code></pre></div></li>
<li>
<p>Unable to log in to the node with a password. No root password is defined in the image by default, one must be added via CFS or by modifying the squashfs filesystem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ncn-m001:# ssh app01
</span></span><span style="display:flex;"><span>Password:
</span></span><span style="display:flex;"><span>Password:
</span></span><span style="display:flex;"><span>Password:
</span></span><span style="display:flex;"><span>root@app01<span style="color:#960050;background-color:#1e0010">&#39;</span>s password:
</span></span><span style="display:flex;"><span>Permission denied, please try again
</span></span></code></pre></div></li>
</ol>
<h3 id="dhcp-hostname-is-not-set">DHCP hostname is not set</h3>
<ol>
<li>
<p>If the node does not have a hostname assigned from DHCP, try verifying the DHCP settings and restarting wicked.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>x3000c0s13b0n0:~ <span style="color:#75715e"># grep -R ^DHCLIENT_SET_HOSTNAME= /etc/sysconfig/network/dhcp</span>
</span></span><span style="display:flex;"><span>DHCLIENT_SET_HOSTNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yes&#34;</span>
</span></span><span style="display:flex;"><span>x3000c0s13b0n0:# systemctl restart wicked
</span></span><span style="display:flex;"><span>x3000c0s13b0n0:# hostnamectl
</span></span><span style="display:flex;"><span>   Static hostname: x3000c0s13b0n0
</span></span><span style="display:flex;"><span>Transient hostname: app01
</span></span><span style="display:flex;"><span>         Icon name: computer-server
</span></span><span style="display:flex;"><span>           Chassis: server
</span></span><span style="display:flex;"><span>        Machine ID: 9bd0aacf29d04dd4827bc464121b130b
</span></span><span style="display:flex;"><span>           Boot ID: af753b4e6fa9419bb14d55a029d0f526
</span></span><span style="display:flex;"><span>  Operating System: SUSE Linux Enterprise High Performance Computing <span style="color:#ae81ff">15</span> SP3
</span></span><span style="display:flex;"><span>       CPE OS Name: cpe:/o:suse:sle_hpc:15:sp3
</span></span><span style="display:flex;"><span>            Kernel: Linux 5.3.18-150300.59.43-default
</span></span><span style="display:flex;"><span>      Architecture: x86-64
</span></span><span style="display:flex;"><span>x3000c0s13b0n0:# hostname
</span></span><span style="display:flex;"><span>app01
</span></span></code></pre></div></li>
</ol>
<h3 id="spire-is-not-running">Spire is not running</h3>
<ol>
<li>
<p>Check the spire-agent logs for error messages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>app01# systemctl status spire-agent
</span></span></code></pre></div></li>
</ol>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation" dir="ltr">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
<a id="logo" href='/docs-uan/'>
  <img src="/docs-uan/images/hpe.png" alt="HPE" />
</a>
        </div>
        <div class="searchbox default-animation">
          <i class="fas fa-search" title=" (CTRL+ALT+f)"></i>
          <label class="a11y-only" for="search-by"></label>
          <input data-search-input id="search-by" name="search-by" class="search-by" type="search" placeholder="">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/docs-uan/js/auto-complete.js?1670951100" defer></script>
        <script src="/docs-uan/js/lunr.min.js?1670951100" defer></script>
        <script src="/docs-uan/js/lunr.stemmer.support.min.js?1670951100" defer></script>
        <script src="/docs-uan/js/lunr.multi.min.js?1670951100" defer></script>
        <script src="/docs-uan/js/lunr.en.min.js?1670951100" defer></script>
        <script src="/docs-uan/js/search.js?1670951100" defer></script>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics">
          <li data-nav-id="/docs-uan/advanced/index.html" class="dd-item parent"><a href="/docs-uan/advanced/index.html">Advanced</a><ul id="subsections-3b2f960022364262aad3600bb7df4641">
          <li data-nav-id="/docs-uan/advanced/sles_image/index.html" class="dd-item active"><a href="/docs-uan/advanced/sles_image/index.html">Booting An Application Node With A Sles Image (techNICal Preview)</a></li></ul></li>
        </ul>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch">
              <div class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-language"></label>
                  <select id="select-language" onchange="location = baseUri + this.value;">
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <div class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-variant"></label>
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="green" value="green" selected>Green</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks"><button class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> </button></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
        </div>
      </div>
    </aside>
    <script src="/docs-uan/js/clipboard.min.js?1670951100" defer></script>
    <script src="/docs-uan/js/perfect-scrollbar.min.js?1670951100" defer></script>
    <script src="/docs-uan/js/featherlight.min.js?1670951100" defer></script>
    <script src="/docs-uan/js/theme.js?1670951100" defer></script>
  </body>
</html>
